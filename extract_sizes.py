import os
import shutil
import pandas as pd
import numpy as np
import re
import glob

os.mkdir('train/bytes')
os.mkdir('train/asm')

os.mkdir('test/bytes')
os.mkdir('test/asm')

#Moving Train files
for file in glob.glob('train/*.bytes'):
    name = file.split('/')[1]
    shutil.move(file, f'train/bytes/{name}')

for file in glob.glob('train/*.asm'):
    name = file.split('/')[1]
    shutil.move(file, f'train/asm/{name}')

#Moving Test files
for file in glob.glob('test/*.bytes'):
    name = file.split('/')[1]
    shutil.move(file, f'test/bytes/{name}')

for file in glob.glob('test/*.asm'):
    name = file.split('/')[1]
    shutil.move(file, f'test/asm/{name}')

#Extracting file size features from train
byte_size = pd.DataFrame(columns=['file', 'byte_size'])
for file in os.listdir('train/bytes/'):
    size = os.path.getsize('train/bytes/'+file) / (1024 * 1024)
    byte_size = byte_size.append({'file': file.split('.')[0], 'byte_size': size}, ignore_index=True)
byte_size.to_csv('train/byte_size.csv', index=False)

asm_size = pd.DataFrame(columns=['file', 'asm_size'])
for file in os.listdir('train/asm/'):
    size = os.path.getsize('train/asm/'+file) / (1024 * 1024)
    asm_size = asm_size.append({'file': file.split('.')[0], 'asm_size': size}, ignore_index=True)
asm_size.to_csv('train/asm_size.csv', index=False)

#Extracting file size features from test
byte_size = pd.DataFrame(columns=['file', 'byte_size'])
for file in os.listdir('test/bytes/'):
    size = os.path.getsize('test/bytes/'+file) / (1024 * 1024)
    byte_size = byte_size.append({'file': file.split('.')[0], 'byte_size': size}, ignore_index=True)
byte_size.to_csv('test/byte_size.csv', index=False)

asm_size = pd.DataFrame(columns=['file', 'asm_size'])
for file in os.listdir('test/asm/'):
    size = os.path.getsize('test/asm/'+file) / (1024 * 1024)
    asm_size = asm_size.append({'file': file.split('.')[0], 'asm_size': size}, ignore_index=True)
asm_size.to_csv('test/asm_size.csv', index=False)